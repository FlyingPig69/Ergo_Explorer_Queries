/* Flying Pig
Execute against explorer psql db */


select
case
	when address = 'MUbV38YgqHy7XbsoXWF5z7EZm524Ybdwe5p9WDrbhruZRtehkRPT92imXer2eTkjwPDfboa1pR3zb3deVKVq3H7Xt98qcTqLuSBSbHb7izzo5jphEpcnqyKJ2xhmpNPVvmtbdJNdvdopPrHHDBbAGGeW7XYTQwEeoRfosXzcDtiGgw97b2aqjTsNFmZk7khBEQywjYfmoDc9nUCJMZ3vbSspnYo3LarLe55mh2Np8MNJqUN9APA6XkhZCrTTDRZb1B4krgFY1sVMswg2ceqguZRvC9pqt3tUUxmSnB24N6dowfVJKhLXwHPbrkHViBv1AKAJTmEaQW2DN1fRmD9ypXxZk8GXmYtxTtrj3BiunQ4qzUCu1eGzxSREjpkFSi2ATLSSDqUwxtRz639sHM6Lav4axoJNPCHbY8pvuBKUxgnGRex8LEGM8DeEJwaJCaoy8dBw9Lz49nq5mSsXLeoC4xpTUmp47Bh7GAZtwkaNreCu74m9rcZ8Di4w1cmdsiK1NWuDh9pJ2Bv7u3EfcurHFVqCkT3P86JUbKnXeNxCypfrWsFuYNKYqmjsix82g9vWcGMmAcu5nagxD4iET86iE2tMMfZZ5vqZNvntQswJyQqv2Wc6MTh4jQx1q2qJZCQe4QdEK63meTGbZNNKMctHQbp3gRkZYNrBtxQyVtNLR8xEY8zGp85GeQKbb37vqLXxRpGiigAdMe3XZA4hhYPmAAU5hpSMYaRAjtvvMT3bNiHRACGrfjvSsEG9G2zY5in2YWz5X9zXQLGTYRsQ4uNFkYoQRCBdjNxGv6R58Xq74zCgt19TxYZ87gPWxkXpWwTaHogG1eps8WXt8QzwJ9rVx6Vu9a5GjtcGsQxHovWmYixgBU8X9fPNJ9UQhYyAWbjtRSuVBtDAmoV1gCBEPwnYVP5GCGhCocbwoYhZkZjFZy6ws4uxVLid3FxuvhWvQrVEDYp7WRvGXbNdCbcSXnbeTrPMey1WPaXX'then 'SigUSD'
	when address = '4L1ktFSzm3SH1UioDuUf5hyaraHird4D2dEACwQ1qHGjSKtA6KaNvSzRCZXZGf9jkfNAEC1SrYaZmCuvb2BKiXk5zW9xuvrXFT7FdNe2KqbymiZvo5UQLAm5jQY8ZBRhTZ4AFtZa1UF5nd4aofwPiL7YkJuyiL5hDHMZL1ZnyL746tHmRYMjAhCgE7d698dRhkdSeVy' then 'Ergo Foundation'
	when address = '5vSUZRZbdVbnk4sJWjg2uhL94VZWRg4iatK9VgMChufzUgdihgvhR8yWSUEJKszzV7Vmi6K8hCyKTNhUaiP8p5ko6YEU9yfHpjVuXdQ4i5p4cRCzch6ZiqWrNukYjv7Vs5jvBwqg5hcEJ8u1eerr537YLWUoxxi1M4vQxuaCihzPKMt8NDXP4WcbN6mfNxxLZeGBvsHVvVmina5THaECosCWozKJFBnscjhpr3AJsdaL8evXAvPfEjGhVMoTKXAb2ZGGRmR8g1eZshaHmgTg2imSiaoXU5eiF3HvBnDuawaCtt674ikZ3oZdekqswcVPGMwqqUKVsGY4QuFeQoGwRkMqEYTdV2UDMMsfrjrBYQYKUBFMwsQGMNBL1VoY78aotXzdeqJCBVKbQdD3ZZWvukhSe4xrz8tcF3PoxpysDLt89boMqZJtGEHTV9UBTBEac6sDyQP693qT3nKaErN8TCXrJBUmHPqKozAg9bwxTqMYkpmb9iVKLSoJxG7MjAj72SRbcqQfNCVTztSwN3cRxSrVtz4p87jNFbVtFzhPg7UqDwNFTaasySCqM' then 'Spectrum Dex'
	when address = '2zYVHmdQDGtyyZfeqFPdMFqWzMdK299yCj5uDJjiSxRgpHyjiV3mVfZCimFbEVkNkCuypT1khjhupnEb6af3ztdatgag24UzLjW7heidiBF4MqK42TBZC1mLNcm851kvjaEwMsm8bnT2ZwJ6g18ZdDtdKTqEq7KBtp9gkvXiScoNNrA55JhC5o1ZdKRfjRqKMsfWBqmUqTNZfLXy62ddoP8oGT6HafqzKp9YLdSr172KYsnJoK3MhRciMG3McYHfkCFzT3fgNiaTosEtDKUSxaDEmY3r6eTF5H1QmYdkDfEe9AGxzjPgcwR19CfTkuGt8Xg3iUnLRciZ6hVBJc642qDR1EBjY8g7sAtestKYxRLKvUrjV9o3rbFccpgREynwf63mHUZ2jFnuuP2YfeJZdhPf6eK7dnLQ6HDkq5JBd76G7ErB17V1yCr7J6DrC6m47B8aY1XU5fFFQ6Hy6fJm7jzb5DHdn3U4V3TdUM5WwMe6hAmTBz3kFtJBKAiqTw5g53doV7CuUWqC9fTKhGo3BYfXtjFCxeJLwxsXx91s5MWT4tST4XBFnoJP6SZKkfuW7ZvtRbcgpVsz37X6o7YxitwNzaDNmkR9GVLU1XK4cQZjfBijQrTXTTApXnq6wPzzvHTgKyxVuQdDcniEDcgQwttTX4mqooCqxshjy79XL3sFCSTxh4Pjm9UjCgq9daTn83Ro2LnHHifaMjXpFGAbySvqwNvxwBHJnsTXKh2fRggxLDLVobBUfq7DxssPfSaeF4exmdU3mhtuhVhFxAaUVY3LBigWcm4642GtzECVmFRLy1y96m7utcqBiMoyNDy8K3hrM6uzpnA5VYuC6s3jqYp6wZ95QCcRyc3roZL6qTrRXiJupiwYXL3FA1THXPAXLm3PgM7VosJth3bj' then 'SigUSD Bank'
	when address = 'BxjSQHD1hqQFUXbXatkn46YUxM6wVsLkT5HNXJe1N1n3dM2c7X8BtgnLqszJuxoRTnzXzrCrmEjPyLxqstcnW7YkQJ9m7QTmhChBYt1hAFcTWiyVMdaiYYFtxr7qfXKcjsadtfusNhS63ZddciC3wogjrfSE3U2Fy9dhrrKStUVzWhTP22ZuwdDPv8F88WVtdLsu24bbHsv2ntXZJGhvdKnvJL83kJWs9XV582sqUBqX7kL2A5qp6T2Jxgt3gLxcZ99JhUG99YtRsmpuwb94TE5KVTESWA6cD8EdReTbP1kwW77rnJyNfj8KUsy1j7AZuNBUsVBc3oLV4GxYFDvaTNEyNBmGY3dEe8k7UKjUSnqCmYH2QM2cmhtPEdT6UBR9sS4h4YFiGsRHiybjuTSaBUPrzhJ12ESKf8jcaNna9rYprzm8ZnfwNEQFtPJyKfCoJjbwkfsAEirsMcyU3VjPAvKJ2mtu7A3WwXViBSfwUgdCnWkEhdPCRPueAXfN38JXG8HjJeZTPi3VtgcnFobg8Zjp1XtRkTaoj6i4BgyfwCft3sCYgBgmNjXhtFuuozpCiAXWyGMMs5rhJL6FzXsJWiTSML96LdshFnhoPRPi8FXVooURKztnqJowFcpLApL2ou2jfeC4iaxKgtd6zDR6ikFVXMsipVHmBrhan9dheUPnfjeXz9WVPmGLmVkrxnVv' then 'Paideia Staking Contract'
	when address = '3eiC8caSy3jiCxCmdsiFNFJ1Ykppmsmff2TEpSsXY1Ha7xbpB923Uv2midKVVkxL3CzGbSS2QURhbHMzP9b9rQUKapP1wpUQYPpH8UebbqVFHJYrSwM3zaNEkBkM9RjjPxHCeHtTnmoun7wzjajrikVFZiWurGTPqNnd1prXnASYh7fd9E2Limc2Zeux4UxjPsLc1i3F9gSjMeSJGZv3SNxrtV14dgPGB9mY1YdziKaaqDVV2Lgq3BJC9eH8a3kqu7kmDygFomy3DiM2hYkippsoAW6bYXL73JMx1tgr462C4d2PE7t83QmNMPzQrD826NZWM2c1kehWB6Y1twd5F9JzEs4Lmd2qJhjQgGg4yyaEG9irTC79pBeGUj98frZv1Aaj6xDmZvM22RtGX5eDBBu2C8GgJw3pUYr3fQuGZj7HKPXFVuk3pSTQRqkWtJvnpc4rfiPYYNpM5wkx6CPenQ39vsdeEi36mDL8Eww6XvyN4cQxzJFcSymATDbQZ1z8yqYSQeeDKF6qCM7ddPr5g5fUzcApepqFrGNg7MqGAs1euvLGHhRk7UoeEpofFfwp3Km5FABdzAsdFR9' then 'Ergopad Staking Contract'
	when address = '5ASYVJ2w8tH3bDMmDvjvgX76HQen4rcvoHku32GsL9js8THW6rduV5VDy8Diue6rRQfp4DRTs4P9bd4vjQY9mmE94A473YeANVps31i76HD88Xk3oeuMgWSgAPuTncfYG1hYHvyT9N7RECUYb64Hs8b2kuvUksccZ841k1vYTmhzseiAFEC59PPnfxxJ4EL9MJ6oHSfwwJBYaZHjmH5eCPkXbJZhGwnTb6bFXvCGGucjDXhmiDPSXGUU49U3r8gN2eTnbh5Dz5mh9eSudUGf7N1fWtT3asz1uruMcdYeNFptD2jFNz6MDTqajZjSEw5guvAmvZAYnfiXwRW8yQyqbd5GcwiuiaPybcGThdf5TLhYxrNeTr1eLn7d1A1RGvySo8dz9vHNrzsK4Zd8HGK4ofhE4kwepyNbYWJY9XbfKVZxqtmLTUHwheNwiJ7cQSCcQUFyMZwAKmjuXdPrVZ9AftFc5gkdqdaC82ya8oMhsbHBV68yorJbp4yyXs8qjaegUfEb4TEZ4L9NsTTsKZxfHB2GypBmssJ6gHGEongQWnca3zqSV9A55SGwbvMQrrkrnvAe9UVsK1h6XwzBj41vF2faVp7Sfp5noqJi9jZjobiCTYA344RW6dNpGS2YpxNzrZtxvyVhmyF9Tms7nSTUMpbF4L' then 'EGIO Staking Contract'
	when address = '26tpZU6i6zeBRuzZVo7tr47zjArAxkHP8x7ijiRbbrvLhySvSU84bH8wNPGGG27EwhJfJLe7bvRPv6B1jQFQqrWUQqBX1XJpVGoiNgveance6JFZ4mKv1KkRE8nBSB3jKBGnVJjJF6wR1Z8YXRsUqrTff4bfmtbhaRRjibnDDtKhS71spfjjTBeU1AhhQpitCDg4NFxmTLyV1arE7G2riZKzDryjWnCiEJGzWNxYtVt8uDxd3qNSRE5sHECwcsb98x7rn4q4FyHMvvWrRMPFfVgAQd5wHCAHwhMEdqUrSFQVkmUMavju8CLAgCNcVFjUBKPX4ooEHLUw3QkxS9Jp6fAFAGmzJ6QVD71mAZYMYhoEQnFyUBx1txJjVJjCrcZsW43dimbt5su4ahATJ8qRtWgwat8vTViTVXAcBmUSnqbqhAqTCxcsS5EFS6ApJSfthPHYUyXwtcbTptfdnUx1e5hEiGcwxoQ8ivufNNiZE9xkxi4nsBBrBVBJ7pfSSoHvbodkzLrq91RHYrvuatyLuBSxgJxs198xUQhULqxmWwgthJLrG5VVfVYH' then 'Skyharbor'
	when address = '5ZGAr8o2JnMqbzUQukynxF4iZ8SeYSpFtrAMszzpnsB1DiPEpexwZ7C7cXTeqqnB7ZMbME8Rqi8b6hyiGzPjfj4THiEucECNLcgzbC9tnDG7E9HbP5vMstiFFapLjFNcW3xmfCZ4tc5LNKp6eUNf1txWWUcFL9zzoamshkhVvhFAfkLGSgAgUUSDMj4psBbXYfvzwU16bwzUS6mZbPn4cacBYj3wSEykPzhTC3SQmhBtueYnnv24foVjdeTiyhuJXz8K4uDibumjECaSgH55cEcWuukQ1SRUyWpk6aNW7snMZBfsUxFgLwAf1PdcM9GeydATVaNAZvxJiDkvCSUEffcZfa8yYxYMy9yUhfWU8k6DFPrSJxkUZNRiKN3t7wsHTZEB4VgzeZ5GjCuwQbvDoz9i9t4Mw3vTn3VU8z8zfzf25k4mg8t5azb7XBd78xh1HMj31jSTs9cExRrqzGJHontB8RSDLfTgTa4EJXzPJeSgtuD85pypSLPLEe7WnJ19Yn3wWcCpjnYhoRypBjaouYtj7zgZYizsy5Gbx3cpa7LsNoKasZPpY4gjvGzPxnbtnJKUgJicca9i6wY7CGzBq8kbUZFb7eJud3yM8jhmyCk5tnt5idf53HHwSLF9dQjVx3aW5jrDzjoa5ZdU4zvENdC1uAU2tKBeHuvTcPoMo' then 'Paideia Emissions'
	when address = '9hXmgvzndtakdSAgJ92fQ8ZjuKirWAw8tyDuyJrXP6sKHVpCz8XbMANK3BVJ1k3WD6ovQKTCasjKL5WMncRB6V9HvmMnJ2WbxYYjtLFS9sifDNXJWugrNEgoVK887bR5oaLZA95yGkMeXVfanxpNDZYaXH9KpHCpC5ohDtaW1PF17b27559toGVCeCUNti7LXyXV8fWS1mVRuz2PhLq5mB7hg2bqn7CZtVM8ntbUJpjkHUc9cP1R8Gvbo1GqcNWgM7gZkr2Dp514BrFz1cXMkv7TYEqH3cdxX9c82hH6fdaf3n6avdtZ5bgqerUZVDDW6ZsqxrqTyTMQUUirRAi3odmMGmuMqDJbU3Z1VnCF9NBow7jrKUDSgckDZakFZNChsr5Kq1kQyNitYJUh9fra1jLHCQ9yekz3te9E' then 'Ergopad Emissions'
	when address = '5ZGAr8o2JnMpF1dVww63EfS6GjpV1sFkVwjAjZFhZXMVXSQTk98pi2AnzAod99QneCNvyuRb3FogtS5mGLprWgq6uFzGgTj3sZRStDDQhU9t983g8wAyBk7Qrpr7EokzJnVrEMsoqpUaqFTX13qTD2FPeDJFPa3yqcGggtki4PNq6St7K6DrHhmStikUbNGHdSqywuRXDiUp1jNgjLAA2M9LmdEUJfPSL7nDcE6UBkfkMRSmAfYPuRS35CfcQMDWmfLJtbzkRP76KZUs4796PxhbX9EVDhEgArAVJgQVxk8skGKCRrrmsYnE4WUgYcSiKY5pGfJXVfoBfiRn6AdYSnFfMcKYqESjM9kb2QBMjYkw5rz95wHxo6CK4EdnkJi7qZJTS39q9DRUoiFZi6dRiRXJtNrJp9JWSbwQjtmubRXqhPy4kwr6uWSSHdy488YpPwxApfch47icQ1cyesN8BDtGY6vYpr69ZaYTQYECSxYHBmWfvyrXKH4ywcF1V9cPsFA5aHsWeyhNdL78vEtjVj8UYHUpR2sVDqGPSUxzJ2YPS2ghPpHm28f3nXhhgdc36S6u9cUJVHiMbCjA4Hk4x4SEHBi96mEwhpeYjcnHgiASgtL7XxDythNbWCt6aXAw7f6o6b5JKqUDooG4iBn7gmBSQQ7WmPKABpLFsWypx' then 'EGIO Emissions'
	when address = '5ASYVJ2w8tH3bDQx5ZLz6rZUdokD1kmTXSRZ8GfrsAUW4vqy9eg5omtTYVzY22ibHANf7GgSc2E5FiThgo8qXzWpU3RDLohN277hksbAf9yykajXbYPUaXUeMPfSXbS1GdE4y2GoYKaXHR3H57MV5CDZE58YteqWe3XVXzmMvj1192AD7UZ1N6nguRfjgijxEWTrLq2ZrykjRAut2JBGYHanAKn46tYWW3chpxNosXG7ZW2ShDzKju2ttHhfxeZVMBydryuoEya5E9KVagjsfa9E2qPUdLpbh8enppVWcwoQ4GF1ktgzSX32QbfKhfpD23iWQixThUbcCca14FjXDt94GVFPuhAT5tQyiKen863Cq5eRAEgsQ7otX6pWa32Q28sxSF9Az4abwiJKNbFhbhb3cDCs6A45ZnW6aB6AkfwTJSAZ2ZzqqG7LXT4HdxNpdmiwno9sJWxPf2PC4vRhVqBPdxxyCgoodjyutf4UuinSCibhfqdhUJLc1JM8zX9UcD699mChgUZoKE8kXD4soVGSgQD3qfGXC6RP7n8dtowArNLm3H5QJ3EobDCbEgECLHFaHN2BPwwWscAt5eejKeFvkp3CuQ3mqFW7vfQG4n9tTLnshj8cjxnpkBdfFKC83sW8A3AoZAX4K1UrhndfLSFh4w' then 'NETA Staking Contract'
	else 'Unknown Contract'
end Contract_Name,

/*  
add new two rows for each token you add, token amount and usd value
change usd value (multiplier) at time of running query
*/

(coalesce(sum(no.value)/1000000000 * 1.49, 0) 
 + coalesce(sum(t_paideia.amount)/10000 * 0.0032,0)
 + coalesce(sum(t_egio.amount)/10000* 0.00009,0)
 + coalesce(sum(t_ergopad.amount)/100 * 0.006,0)
 + coalesce(sum(t_spf.amount)/1000000 * 0.063,0)
 + coalesce(sum(t_neta.amount)/1000000 * 0.0034,0)
 + coalesce(sum(t_sigUSD.amount)/100,0)) as TVL_USD,

coalesce(sum(no.value)/1000000000,0) as ERG_amount,
coalesce(sum(no.value)/1000000000 * 1.49,0) as ERG_USD, 
	
coalesce(sum(t_paideia.amount)/10000,0) as paideia_amount, 
coalesce((sum(t_paideia.amount)/10000 * 0.0032),0) as paideia_USD,

coalesce(sum(t_egio.amount)/10000,0) as egio_amount,
coalesce((sum(t_egio.amount)/10000)* 0.00009,0) as egio_USD,

coalesce(sum(t_ergopad.amount)/100,0) as ergopad_amount,
coalesce((sum(t_ergopad.amount)/100 * 0.006),0) as ergopad_USD,

coalesce(sum(t_spf.amount)/1000000,0) as spf_amount,
coalesce((sum(t_spf.amount)/1000000 * 0.063),0) as spf_USD,

coalesce(sum(t_neta.amount)/1000000,0) as neta_amount,
coalesce((sum(t_neta.amount)/1000000 * 0.0034),0) as neta_USD,

coalesce(sum(t_sigUSD.amount)/100,0) as sigUSD_amount,

no.address

from node_outputs no

left join
(select ni.box_id
  from node_inputs ni
where ni.main_chain = true ) i
on i.box_id = no.box_id

/* 
Add a new join and token ID plus name for each token you want to track. 
Need to add to initial select aswell
*/
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = '1fd6e032e8476c4aa54c18c1a308dce83940e8f4a28f576440513ed7326ad489' 
		 and node_assets.value is not Null) t_paideia
		 on t_paideia.box_id=no.box_id
		 
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = 'd71693c49a84fbbecd4908c94813b46514b18b67a99952dc1e6e4791556de413' 
		 and node_assets.value is not Null) t_ergopad
		 on t_ergopad.box_id=no.box_id
		 
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = '00b1e236b60b95c2c6f8007a9d89bc460fc9e78f98b09faec9449007b40bccf3' 
		 and node_assets.value is not Null) t_egio
		 on t_egio.box_id=no.box_id
		 
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = '9a06d9e545a41fd51eeffc5e20d818073bf820c635e2a9d922269913e0de369d' 
		 and node_assets.value is not Null) t_spf
		 on t_spf.box_id=no.box_id
		 
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = '472c3d4ecaa08fb7392ff041ee2e6af75f4a558810a74b28600549d5392810e8' 
		 and node_assets.value is not Null) t_neta
		 on t_neta.box_id=no.box_id
		 
left join(select box_id, node_assets.value as amount
		 from node_assets
		 where token_id = '03faf2cb329f2e90d6d23b58d91bbb6c046aa143261cc21f52fbe2824bfcbf04' 
		 and node_assets.value is not Null) t_sigUSD
		 on t_sigUSD.box_id=no.box_id
		 	 
where no.main_chain = true
and not exists (select box_id from node_inputs ni where no.box_id = ni.box_id)
and no.address not like '9%%' /* normal wallet addresses */
and no.address not like '88%%' /* mining contracts */
and no.address not like '2Z4YBkDsDvQj8BX7xiySFewjitqp2ge9c99jfes2whbtKitZTxdBYqbrVZUvZvKv6aqn9by4kp3LE1c26LCyosFnVnm6b6U1JYvWpYmL2ZnixJbXLjWAWuBThV1D6dLpqZJYQHYDznJCk49g5TUiS4q8khpag2aNmHwREV7JSsypHdHLgJT7MGaw51aJfNubyzSKxZ4AJXFS27EfXwyCLzW1K6GVqwkJtCoPvrcLqmqwacAWJPkmh78nke9H4oT88XmSbRt2n9aWZjosiZCafZ4osUDxmZcc5QVEeTWn8drSraY3eFKe8Mu9MSCcVU' /* Main emissions contract */
and no.address not like '6KxusedL87PBibr1t1f4ggzAyTAmWEPqSpqXbkdoybNwHVw5Nb7cUESBmQw5XK8TyvbQiueyqkR9XMNaUgpWx3jT54p' /* re-emissions contract */
group by no.address;
